import{_ as q,d as U,e as K,p as J,q as ee,c as f,a as E,o as i,w as s,b as d,f as g,g as R,t as S,h as a,r as n,j as I,s as G,k as V,F as z,v as te,x as ae,y as se,z as Y,l as le,m as oe,E as H,u as ne}from"./index-DlvedrGh.js";const re={name:"TaskItem",components:{Edit:K,Delete:U},props:{task:{type:Object,required:!0},projectId:{type:String,required:!0}},emits:["status-change","delete"],setup(l,{emit:t}){const r=[{label:"All",value:"all"},{label:"Pending",value:"pending"},{label:"In Progress",value:"in-progress"},{label:"Completed",value:"completed"}],e=J(l.task.status);ee(()=>{e.value=l.task.status});const D=_=>{t("status-change",l.task.id,_)},O=f(()=>{switch(l.task.priority){case"high":return"danger";case"medium":return"warning";case"low":return"success";default:return"info"}}),T=f(()=>l.task.description?l.task.description.length>60?l.task.description.substring(0,60)+"...":l.task.description:""),p=f(()=>l.task.dueDate?(console.log("due date",l.task.dueDate),new Date(l.task.dueDate).toLocaleDateString("en-GB",{year:"numeric",month:"short",day:"numeric"})):""),u=f(()=>{if(!l.task.dueDate||l.task.status==="completed")return!1;const _=new Date;return _.setHours(0,0,0,0),new Date(l.task.dueDate)<_});return{statusOptions:r,currentStatus:e,handleStatusChange:D,priorityTagType:O,formattedDueDate:p,isOverdue:u,truncatedDescription:T}}},ie={class:"task-header"},ce={class:"task-title"},de={class:"task-actions"},ue={key:0,class:"task-description"},_e={class:"task-details"},pe={class:"detail-item"},me={key:0,class:"detail-item"},ke={class:"task-status"};function ye(l,t,r,e,D,O){const T=n("Delete"),p=n("el-icon"),u=n("el-button"),_=n("Edit"),m=n("router-link"),h=n("el-tag"),A=n("el-option"),B=n("el-select"),c=n("el-card");return i(),E(c,{class:G(["task-item",`priority-${r.task.priority}`])},{default:s(()=>[d("div",ie,[d("h3",ce,S(r.task.title),1),d("div",de,[a(u,{size:"small",type:"danger",circle:"",onClick:t[0]||(t[0]=j=>l.$emit("delete",r.task))},{default:s(()=>[a(p,null,{default:s(()=>[a(T)]),_:1})]),_:1}),a(m,{to:`/projects/${r.projectId}/tasks/${r.task.id}/edit`},{default:s(()=>[a(u,{size:"small",type:"primary",circle:""},{default:s(()=>[a(p,null,{default:s(()=>[a(_)]),_:1})]),_:1})]),_:1},8,["to"])])]),e.truncatedDescription?(i(),g("p",ue,S(e.truncatedDescription),1)):R("",!0),d("div",_e,[d("div",pe,[a(h,{type:e.priorityTagType,effect:"light",size:"small"},{default:s(()=>[I(S(r.task.priority.charAt(0).toUpperCase()+r.task.priority.slice(1))+" Priority ",1)]),_:1},8,["type"])]),r.task.dueDate?(i(),g("div",me,[t[2]||(t[2]=d("span",{class:"detail-label"},"Due:",-1)),d("span",{class:G({overdue:e.isOverdue})},S(e.formattedDueDate),3)])):R("",!0)]),d("div",ke,[a(B,{modelValue:e.currentStatus,"onUpdate:modelValue":t[1]||(t[1]=j=>e.currentStatus=j),placeholder:"Status",size:"small",onChange:e.handleStatusChange},{default:s(()=>[(i(!0),g(z,null,V(e.statusOptions,j=>(i(),E(A,{key:j.value,label:j.label,value:j.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])])]),_:1},8,["class"])}const fe=q(re,[["render",ye],["__scopeId","data-v-c33585ad"]]),ge={name:"KanbanColumn",components:{TaskItem:fe},props:{title:{type:String,required:!0},type:{type:String,required:!0,validator:l=>["pending","in-progress","completed"].includes(l)},tasks:{type:Array,default:()=>[]},projectId:{type:String,required:!0},emptyText:{type:String,default:""}},emits:["status-change","delete"]},ve={class:"kanban-column"},De={class:"task-count"},he={class:"column-content"},je={key:0,class:"empty-column"};function Te(l,t,r,e,D,O){const T=n("task-item");return i(),g("div",ve,[d("div",{class:G(["column-header",r.type])},[d("h3",null,S(r.title),1),d("span",De,S(r.tasks.length),1)],2),d("div",he,[r.tasks.length===0?(i(),g("div",je,[d("p",null,"No "+S(r.emptyText)+" tasks",1)])):R("",!0),(i(!0),g(z,null,V(r.tasks,p=>(i(),E(T,{key:p.id,task:p,"project-id":r.projectId,onStatusChange:t[0]||(t[0]=u=>l.$emit("status-change",u)),onDelete:t[1]||(t[1]=u=>l.$emit("delete",u)),class:"task-card"},null,8,["task","project-id"]))),128))])])}const Se=q(ge,[["render",Te],["__scopeId","data-v-36be718a"]]),be={name:"ProjectDetail",components:{KanbanColumn:Se,Edit:K,Delete:U,Plus:ae,Close:te},props:{id:{type:String,required:!0}},setup(l){const t=le(),r=ne(),e={PRIORITY_FILTER:`project_${l.id}_priority_filter`,SORT_BY:`project_${l.id}_sort_by`},D={PENDING:"pending",IN_PROGRESS:"in-progress",COMPLETED:"completed"},O=[{label:"Pending",value:D.PENDING},{label:"In Progress",value:D.IN_PROGRESS},{label:"Completed",value:D.COMPLETED}],T=[{label:"All",value:"all"},{label:"Low",value:"low"},{label:"Medium",value:"medium"},{label:"High",value:"high"}],p=[{label:"Due Date (Ascending)",value:"dueDate-asc"},{label:"Due Date (Descending)",value:"dueDate-desc"},{label:"Priority (Highest first)",value:"priority-desc"},{label:"Priority (Lowest first)",value:"priority-asc"},{label:"Title (A-Z)",value:"title-asc"},{label:"Title (Z-A)",value:"title-desc"}],u=(o,v)=>{try{const y=localStorage.getItem(o);return y?JSON.parse(y):v}catch(y){return console.error("Error loading from localStorage:",y),v}},_=(o,v)=>{try{localStorage.setItem(o,JSON.stringify(v))}catch(y){console.error("Error saving to localStorage:",y)}},m=se({priority:u(e.PRIORITY_FILTER,"all")}),h=J(u(e.SORT_BY,"dueDate-asc"));Y(()=>m.priority,o=>{_(e.PRIORITY_FILTER,o)}),Y(h,o=>{_(e.SORT_BY,o)});const A=f(()=>t.getters["projects/isLoading"]),B=f(()=>t.getters["projects/allProjects"]),c=f(()=>B.value.find(o=>o.id===l.id)||null),j=f(()=>c.value&&c.value.tasks?c.value.tasks:[]),w=f(()=>{let o=j.value.filter(v=>!m.priority||m.priority==="all"?!0:v.priority===m.priority);if(h.value){const[v,y]=h.value.split("-");o=[...o].sort((b,F)=>{if(v==="dueDate"){const C=b.dueDate?new Date(b.dueDate):new Date(0),P=F.dueDate?new Date(F.dueDate):new Date(0);return y==="asc"?C-P:P-C}if(v==="priority"){const C={low:1,medium:2,high:3},P=C[b.priority]||0,M=C[F.priority]||0;return y==="asc"?P-M:M-P}if(v==="title"){const C=b.title.toLowerCase(),P=F.title.toLowerCase();return y==="asc"?C.localeCompare(P):P.localeCompare(C)}return 0})}return o}),N=f(()=>w.value.filter(o=>o.status===D.PENDING)),L=f(()=>w.value.filter(o=>o.status===D.IN_PROGRESS)),x=f(()=>w.value.filter(o=>o.status===D.COMPLETED));oe(()=>{k()});function k(){t.dispatch("projects/fetchProjects")}Y(c,o=>{!o&&!A.value&&B.value.length>0&&r.push({name:"Home"})});const W=(o,v)=>{if(!c.value)return;const y=c.value.tasks.find(b=>b.id===o);if(y){const b={...y,status:v};t.dispatch("tasks/updateTask",{projectId:c.value.id,task:b})}},Z=o=>{H.confirm(`Are you sure you want to delete task "${o.title}"?`,"Warning",{confirmButtonText:"Yes, Delete",cancelButtonText:"Cancel",type:"warning"}).then(()=>{t.dispatch("tasks/deleteTask",{projectId:c.value.id,taskId:o.id})}).catch(()=>{})},Q=()=>{c.value&&H.confirm(`Are you sure you want to delete project "${c.value.name}"? All associated tasks will also be deleted.`,"Warning",{confirmButtonText:"Yes, Delete",cancelButtonText:"Cancel",type:"warning"}).then(()=>{t.dispatch("projects/deleteProject",c.value.id).then(()=>{r.push({name:"Home"})})}).catch(()=>{})},X=()=>{m.priority="all"},$=f(()=>m.priority!=="all"||h.value!=="dueDate-asc");return{project:c,tasks:j,filteredTasks:w,pendingTasks:N,inProgressTasks:L,completedTasks:x,isLoading:A,statusOptions:O,priorityOptions:T,sortOptions:p,filters:m,sortBy:h,isFilterActive:$,updateTaskStatus:W,confirmDeleteTask:Z,confirmDeleteProject:Q,handlePriorityClear:X,clearAllFilters:()=>{m.priority="all",h.value="dueDate-asc"}}}},Ce={class:"proj-detail"},Pe={key:0,class:"proj-header"},we={class:"title-wrapper"},Ie={class:"proj-title"},Ee={class:"actions"},Oe={class:"proj-description"},Ae={key:2,class:"task-section"},Be={class:"header-content"},Re={key:0,class:"filter-indicator"},xe={key:1,class:"kanban-board"};function Ne(l,t,r,e,D,O){const T=n("Edit"),p=n("el-icon"),u=n("el-button"),_=n("router-link"),m=n("Delete"),h=n("el-empty"),A=n("Close"),B=n("el-tag"),c=n("el-col"),j=n("Plus"),w=n("el-row"),N=n("el-option"),L=n("el-select"),x=n("kanban-column");return i(),g("div",Ce,[e.project?(i(),g("div",Pe,[d("div",we,[d("h1",Ie,S(e.project.name),1),d("div",Ee,[a(_,{to:`/projects/${e.project.id}/edit`},{default:s(()=>[a(u,{type:"primary",size:"small"},{default:s(()=>[a(p,null,{default:s(()=>[a(T)]),_:1}),t[2]||(t[2]=I(" Edit Project "))]),_:1})]),_:1},8,["to"]),a(u,{type:"danger",size:"small",onClick:e.confirmDeleteProject},{default:s(()=>[a(p,null,{default:s(()=>[a(m)]),_:1}),t[3]||(t[3]=I(" Delete Project "))]),_:1},8,["onClick"])])]),d("p",Oe,S(e.project.description),1)])):e.isLoading?R("",!0):(i(),E(h,{key:1,description:"Project not found"},{default:s(()=>[a(_,{to:"/"},{default:s(()=>[a(u,{type:"primary"},{default:s(()=>t[4]||(t[4]=[I("Back to Projects")])),_:1})]),_:1})]),_:1})),e.project?(i(),g("div",Ae,[a(w,{class:"task-header",gutter:10},{default:s(()=>[a(c,{xs:18,sm:20},{default:s(()=>[d("div",Be,[t[6]||(t[6]=d("h2",{class:"section-title"},"Tasks",-1)),e.isFilterActive?(i(),g("div",Re,[a(B,{size:"small",type:"info"},{default:s(()=>[t[5]||(t[5]=I(" Filtered ")),a(u,{type:"text",size:"small",class:"clear-btn",onClick:e.clearAllFilters},{default:s(()=>[a(p,null,{default:s(()=>[a(A)]),_:1})]),_:1},8,["onClick"])]),_:1})])):R("",!0)])]),_:1}),a(c,{xs:6,sm:4,style:{"text-align":"right"}},{default:s(()=>[a(_,{to:`/projects/${e.project.id}/tasks/new`},{default:s(()=>[a(u,{type:"success",size:"small"},{default:s(()=>[a(p,null,{default:s(()=>[a(j)]),_:1}),t[7]||(t[7]=I(" Add "))]),_:1})]),_:1},8,["to"])]),_:1})]),_:1}),a(w,{class:"filters",gutter:10},{default:s(()=>[a(c,{span:12},{default:s(()=>[a(L,{modelValue:e.filters.priority,"onUpdate:modelValue":t[0]||(t[0]=k=>e.filters.priority=k),placeholder:"Filter by Priority",clearable:"",class:"filter-select",style:{width:"100%"},onClear:e.handlePriorityClear},{default:s(()=>[(i(!0),g(z,null,V(e.priorityOptions,k=>(i(),E(N,{key:k.value,label:k.label,value:k.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onClear"])]),_:1}),a(c,{span:12},{default:s(()=>[a(L,{modelValue:e.sortBy,"onUpdate:modelValue":t[1]||(t[1]=k=>e.sortBy=k),placeholder:"Sort By",class:"filter-select",style:{width:"100%"}},{default:s(()=>[(i(!0),g(z,null,V(e.sortOptions,k=>(i(),E(N,{key:k.value,label:k.label,value:k.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),!e.isLoading&&e.tasks.length===0?(i(),E(h,{key:0,description:"No tasks found"},{default:s(()=>[a(_,{to:`/projects/${e.project.id}/tasks/new`},{default:s(()=>[a(u,{type:"primary"},{default:s(()=>t[8]||(t[8]=[I("Create New Task")])),_:1})]),_:1},8,["to"])]),_:1})):(i(),g("div",xe,[a(x,{title:"Pending",type:"pending",tasks:e.pendingTasks,"project-id":e.project.id,"empty-text":"pending",onStatusChange:e.updateTaskStatus,onDelete:e.confirmDeleteTask},null,8,["tasks","project-id","onStatusChange","onDelete"]),a(x,{title:"In Progress",type:"in-progress",tasks:e.inProgressTasks,"project-id":e.project.id,"empty-text":"in progress",onStatusChange:e.updateTaskStatus,onDelete:e.confirmDeleteTask},null,8,["tasks","project-id","onStatusChange","onDelete"]),a(x,{title:"Completed",type:"completed",tasks:e.completedTasks,"project-id":e.project.id,"empty-text":"completed",onStatusChange:e.updateTaskStatus,onDelete:e.confirmDeleteTask},null,8,["tasks","project-id","onStatusChange","onDelete"])]))])):R("",!0)])}const Ve=q(be,[["render",Ne],["__scopeId","data-v-466264b3"]]);export{Ve as default};
